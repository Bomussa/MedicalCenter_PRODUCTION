# 📌 المركز الطبي التخصصي العسكري - العطار  
**قسم اللجنة الطبية العسكرية**  
إصدار: 1.0.0

---

## 🩺 نظرة عامة
تطبيق ويب (PWA) لإدارة وتنظيم الفحوصات الطبية العسكرية، مخصص للمراجعين والإدارة، مع دعم كامل للغة العربية والإنجليزية، وإدارة المسارات الطبية، وتوليد أكواد يومية للعيادات، وتقارير شاملة.

---

## 📂 هيكل المشروع

```
attarmedical/
├─ public/
│  ├─ assets/
│  │  └─ logo-medical-services.png   ← الشعار الرسمي
│  ├─ manifest.webmanifest           ← إعدادات PWA
│  └─ favicon.ico                     ← أيقونة المتصفح
├─ src/
│  ├─ app.config.ts                   ← الهوية والثيم
│  ├─ i18n.ts                         ← النصوص متعددة اللغات
│  ├─ main.tsx                        ← نقطة الدخول
│  ├─ context/AppContext.tsx          ← الحالة العامة للتطبيق
│  ├─ components/                     ← جميع الشاشات والمكونات
│  │  ├─ StartScreen.tsx
│  │  ├─ ExamScreen.tsx
│  │  ├─ FlowScreen.tsx
│  │  ├─ AdminLogin.tsx
│  │  ├─ AdminDashboard.tsx
│  │  ├─ RecordsManager.tsx
│  │  └─ Reports.tsx
│  ├─ data/                           ← بيانات العيادات والفحوص
│  │  ├─ clinics.ts
│  │  └─ exams.ts
│  ├─ utils/                          ← الأدوات والمرافق
│  │  ├─ env.ts
│  │  ├─ time.ts
│  │  ├─ storage.ts
│  │  ├─ crypto.ts
│  │  ├─ validators.ts
│  │  ├─ audit.ts
│  │  ├─ dailyCodes.ts
│  │  ├─ loadBalancer.ts
│  │  ├─ records.ts
│  │  └─ exports.ts
├─ .env.production                    ← ملف البيئة للنشر
├─ package.json
├─ vite.config.ts
└─ README.md
```

---

## ⚙️ الإعدادات الافتراضية

ملف `.env.production`:

```bash
VITE_ADMIN_USER=superadmin
VITE_ADMIN_PASS=StrongPass!2025
VITE_ADMIN_2FA=14490
VITE_SESSION_MINUTES=15
VITE_ENCRYPTION_KEY=AttarMedicalKey2025
VITE_MODELS_POLICY=HYBRID
```

---

🚀 خطوات التشغيل محليًا

1. تثبيت الحزم:
   ```bash
   npm install
   ```
2. تشغيل بيئة التطوير:
   ```bash
   npm run dev
   ```
3. بناء نسخة الإنتاج:
   ```bash
   npm run build
   ```
4. معاينة نسخة الإنتاج:
   ```bash
   npm run preview
   ```

---

🌐 النشر على الويب

1. بعد تنفيذ `npm run build`، سيُنشأ مجلد `dist/`.
2. ارفع محتويات `dist/` إلى الاستضافة (Vercel / Netlify / Nginx).
3. تأكد من تفعيل HTTPS.
4. أنشئ QR Code للرابط الرئيسي للتطبيق.

---

🖥️ طريقة عمل التطبيق

### للمراجع
1. إدخال الرقم العسكري (2–12 رقم) أو الشخصي (8–15 رقم).
2. اختيار الجنس.
3. اختيار نوع الفحص.
4. استلام مسار العيادات مع قفل PIN لكل عيادة.
5. إنهاء الجولة → حفظ الزيارة + عرض ملخص PDF.

### للإدارة
1. تسجيل الدخول (super_admin من ENV أو أدمن من لوحة الإدارة).
2. عرض الإحصائيات المباشرة.
3. عرض أكواد العيادات اليومية (تتجدد 05:00 قطر).
4. عرض السجلات والتقارير (Read-Only) مع فلاتر وتصدير.
5. تقرير شهري مفصل بالإجمالي والتفصيل حسب نوع الفحص.

---

📊 التقارير

• جدول الزيارات: الرقم العسكري/الشخصي، نوع الفحص، البداية، النهاية، المدة.

• عدد المراجعين لكل عيادة: جدول مجمّع من بيانات الزيارات.

• تقرير شهري: إجمالي الفحوصات والمراجعين، وتفصيل حسب نوع الفحص.

• التصدير: CSV / Excel / PDF مع الشعار والعناوين الرسمية.

---

🛡️ الأمان

• تخزين محلي مشفر AES.

• جلسات إدارية تنتهي تلقائيًا.

• سجل تدقيق لكل العمليات الحساسة.

• لا تعديل على السجلات/التقارير من الواجهة.

---

🛠️ معالجة الأخطاء

• إدخال خاطئ: رسائل ودّية وتعطيل زر المتابعة.

• جلسة منتهية: إعادة توجيه لتسجيل الدخول.

• فشل تحميل البيانات: fallback آمن وإعادة المحاولة.

• أكواد يومية مفقودة: توليد فوري عند فتح التطبيق.

---

📅 خطة الفحص (4 مراحل)

1. المدخلات/اللغة/UI: تحقق Regex، تبديل اللغة، عدم التمرير الأفقي.

2. المسارات/النماذج/التنبيهات: توزيع A/B/C/D، تنبيهات M والنسائي مرة واحدة، شريط التقدّم.

3. الإدارة/الأمان: super_admin من ENV، إنشاء أدمن جديد، انتهاء الجلسة، التقارير Read-Only.

4. التقارير/الإحصائيات/الأكواد: جدول الزيارات، عدد المراجعين لكل عيادة، تقرير شهري، شعار في PDF، أكواد يومية عند 05:00 قطر.

---

📌 روابط مهمة بعد النشر

• التطبيق الرئيسي: `https://attarmedical.example.com`

• لوحة الإدارة: `https://attarmedical.example.com/admin`

• التقارير: `https://attarmedical.example.com/reports`

• السجلات: `https://attarmedical.example.com/records`

---